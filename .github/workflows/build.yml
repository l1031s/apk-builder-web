name: Android APK Builder Server

on:
  repository_dispatch:
    types: [build_apk]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4

    - name: ğŸ“¦ í”„ë¡œì íŠ¸ ZIP ë‹¤ìš´ë¡œë“œ
      run: |
        curl -L "${{ github.event.client_payload.zip_url }}" -o project.zip
        unzip project.zip -d project

    - name: â˜• JDK 17 ì„¤ì¹˜
      uses: actions/setup-java@v4
      with:
        distribution: temurin
        java-version: 17

    - name: ğŸ“± Android SDK ì„¤ì¹˜
      uses: android-actions/setup-android@v3

    - name: ğŸ”§ Gradle ì‹¤í–‰ ê¶Œí•œ
      run: |
        cd project
        chmod +x gradlew

    - name: ğŸ—ï¸ APK ë¹Œë“œ
      run: |
        cd project
        ./gradlew assembleDebug

    - name: ğŸ“¤ APK ì—…ë¡œë“œ
      uses: actions/upload-artifact@v4
      with:
        name: output-apk
        path: project/**/build/outputs/apk/**/*.apk
